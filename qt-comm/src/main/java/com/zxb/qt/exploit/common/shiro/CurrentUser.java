package com.zxb.qt.exploit.common.shiro;


import com.zxb.qt.exploit.common.boot.exception.BlogException;
import com.zxb.qt.exploit.entity.User;
import org.apache.shiro.SecurityUtils;
import org.apache.shiro.subject.Subject;
import org.springframework.stereotype.Component;

import java.lang.annotation.*;

public class CurrentUser {

    public static User getUser(){
        Subject currentUser = SecurityUtils.getSubject();
        System.out.println( "得到的值 : " + (User) currentUser.getPrincipal()  );
        if ( !currentUser.isAuthenticated() ){
            throw new BlogException( "-1" , "您还未登陆" );
        }
        return (User) currentUser.getPrincipal() ;
    }

    /**
     * 在模板引擎中 获取用户信息 不抛出异常
     * @param isTemplate
     * @return
     */
    public static User getUser( Boolean isTemplate  ){
//        boolean isTemplate = template.equals( "true" ) ? true : false ;
        Subject currentUser = SecurityUtils.getSubject();
        System.out.println( "得到的值 : " + (User) currentUser.getPrincipal()  );
        if ( !currentUser.isAuthenticated() && isTemplate ){
             new BlogException( "-1" , "您还未登陆" );
        }
        if ( !currentUser.isAuthenticated() && !isTemplate ){
            throw new BlogException( "-1" , "您还未登陆" );
        }
        return (User) currentUser.getPrincipal() ;
    }

}
