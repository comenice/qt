package com.zxb.qt.exploit.common.service.property;


import com.baomidou.mybatisplus.annotation.TableField;
import com.baomidou.mybatisplus.annotation.TableId;
import com.baomidou.mybatisplus.core.conditions.Wrapper;
import com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;
import com.zxb.qt.exploit.entity.Index;
import com.zxb.qt.exploit.entity.ServiceConf;
import com.zxb.qt.exploit.entity.User;
import com.zxb.qt.exploit.mapper.IndexMapper;
import com.zxb.qt.exploit.mapper.ServiceConfMapper;
import com.zxb.qt.exploit.mapper.UserMapper;
import lombok.Getter;
import lombok.Setter;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import javax.annotation.PostConstruct;


/**
 * 服务器配置
 */
@SuppressWarnings("AccessStaticViaInstance")
@Configuration
@Getter
@Setter
public  class  ServiceConfigProperty {

    public final Integer defaultId = 1 ;
    public static Integer id;

    /**
     * IP
     */
    public static String serviceIp;

    /**
     * 端口
     */
    public static String[] servicePorts;

    /**
     * 域名
     */
    public static String[] serviceDomain;

    /**
     * 文件资源 路径
     */
    public static String serviceFile;

    /**
     * 图片资源 路径
     */
    public static String serviceImg;

    /**
     * 文件图片资源 路径
     */
    public static String serviceFileImg;

    @Autowired
    public ServiceConfMapper serviceConfMapper;



    //@PostConstruct
    @Bean
    public void  config(){
        System.out.println( "初始化 服务器配置属性" );
        ServiceConf serviceConf = serviceConfMapper.selectOne( new QueryWrapper<ServiceConf>().eq("ID",defaultId) );
        this.id = serviceConf.getId();
        this.serviceIp = serviceConf.getServiceIp();
        this.serviceDomain = serviceConf.getServiceDomain().split( "\\|" );
        this.servicePorts = serviceConf.getServiceDomain().split("\\|");
        this.serviceFile = serviceConf.getServiceFile();
        this.serviceImg = serviceConf.getServiceImg();
        this.serviceFileImg = serviceIp  + serviceConf.getServiceFileImg();
    }


}
