package com.zxb.qt.exploit.common.redis.cache.module.fp;

import com.zxb.qt.exploit.common.redis.RedisKeys;
import com.zxb.qt.exploit.common.redis.cache.module.CacheModuleAdapter;
import com.zxb.qt.exploit.entity.BlogTag;
import com.zxb.qt.exploit.mapper.BlogTagMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;


@Component
public class CacheTags extends CacheModuleAdapter {

    @Autowired
    private BlogTagMapper blogTagMapper;

    @Override
    public Boolean cacheData() {
        Map map = null;
        if ( !redisUtils.hasKey( RedisKeys.DEFAULT_BLOG_TAG_HASH ) ){
            List<BlogTag> list = blogTagMapper.selectList( null );
            map = list.stream().collect(Collectors.toMap( BlogTag::getId , a -> a,(k1, k2)->k1)   );
            return redisUtils.hmset( RedisKeys.DEFAULT_BLOG_TAG_HASH  , map , maxInt  );
        }
        return false ;
    }

    @Override
    public Boolean setData(Object o) {
        return super.setData(o);
    }
}

