package com.zxb.qt.exploit.common.shiro;

import com.zxb.qt.exploit.entity.User;
import org.apache.shiro.crypto.RandomNumberGenerator;
import org.apache.shiro.crypto.SecureRandomNumberGenerator;
import org.apache.shiro.crypto.hash.SimpleHash;
import org.apache.shiro.util.ByteSource;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.PropertySource;
import org.springframework.context.annotation.PropertySources;
import org.springframework.stereotype.Component;


@Component
@PropertySource("classpath:application-comm.properties")
public class PassWordHelper {

    @Value( "${shrio.hash.iterations}" )
    private int iterations = 10; //迭代次数
    @Value( "${shrio.hash.algorithm}" )
    private String algorithm = "MD5";  //加密类型


    private RandomNumberGenerator generator = new SecureRandomNumberGenerator();

    public void encryptionMD5(User user){
        // hash 加密 这种加密是不可逆的 下次登陆需要用先同的办法加密用户输入的密码 来判断是否先同
        String salt = generator.nextBytes().toHex();
        user.setSalt( salt );
        String result = new SimpleHash(algorithm,user.getPassWord(),salt,iterations).toString();
        user.setPassWord( result );
    }



//    public static void main(String[] args) {
//        String user = "郑晓波" ;
//        String pwd = "123456";
//        int iterations = 10 ;
//        String algorithm = "MD5";
//        RandomNumberGenerator generator = new SecureRandomNumberGenerator();
//        String  salt =  generator.nextBytes().toHex();
//
//        String result = new SimpleHash(algorithm,pwd,salt,iterations).toString();
//        System.out.println( result );
//       // 8a56dfac183cba97d6158c8619c993ec
//        System.out.println( salt );
//    }


}
